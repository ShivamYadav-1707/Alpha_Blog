
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <title>users</title>
    <style>
        table, th, td {
            border: 1px solid white;
            border-collapse: collapse;
            border-style: inset;
        }
        .bt{
            color:white;
        }
    </style>
    
</head>
<body>
    <div style="text-align:center">
        <br>
        <br>
        <br>
        <h1>List of all users</h1>
    </div>
    <div style="padding-left:10px">
        <%= search_form_for @q,:html => {:id => "search_form"} do |f| %>
            <div class="form-row align-items-center">
                <div class="col-auto">
                    <%= f.search_field :email_or_name_or_gender_cont,class: "form-control mb-2", id: "search_input", placeholder: "Search"%>
                </div>
               
            </div>
        <%end%>
    </div>
             
            
    <%if user_signed_in? && current_user.is_admin?%>
        <div style="text-align:right;padding-right: 9px;">
            <div style="text-align:right;padding-right:12px">
                <%= link_to 'Add user', "/admin_new_user",  {:remote => true, 'data-toggle' =>  "modal", 'data-target' => '#modal-window', class: 'bt btn btn-warning btn-lg'}  %>
            </div>
        </div>
    <%else%>
        <br><br>
    <%end%>

    <div id="modal-window" class="modal hide fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
            </div>
        </div>
    </div>

    <br><div style="padding-left:10px;padding-right:10px">
        <table class="table table-responsive w-100 d-block d-md-table">
            <th scope="col" class="table-primary">
                <h3>user</h3>
            </th>
            <th scoper="col" class="table-primary">
                <h3>Gender</h3>
            </th>
            <th  scoper="col" class="table-primary">
                <h3>Email</h3>
            </th>
            <th  scoper="col" class="table-primary">
                <h3>Operations</h3>
            </th>
            <%@t=0%>
            <% @user.each do|user|%>
                <tr class="table-<%= @t%2==0?"active": "light"%>">
                    <%@t=@t+1%>
                <td>
                        <%if user.cover_picture.attached? %>
                            <%= image_tag user.cover_picture, style:"width: 50px;height: 50px; display: block ;text-align:center;transform:translate(5px);"%>
                        <%end%>
                            <h3><%=link_to user.name,user_path(user)%> </h3>
                    </td>
                    <td>
                        <h3><%= user.gender%></h3>
                    </td>
                    <td>
                    <h3> <%= user.email%></h3>
                    </td>
                    <td style="text-align:center">
                        <p style="font-size:24px ">
                            <%if user_signed_in?%>
                                <%if current_user.is_admin?%>
                                    <p  style="font-size:12px">
                                    <%= link_to "/admin_edit/#{user.id}" do%>
                                        <%= fa_icon "edit",class: "btn btn-outline-info" %>
                                    <% end %>
                                    <%= link_to '<i class="fa fa-trash-o fa-2x"></i>'.html_safe, user_path(user), class: "btn btn-outline-danger", method: :delete, data: {confirm: "Are you sure you want to delete the User?"} %>
                                    </p>
                                <%elsif can? :update, user%>
                                    <%= link_to edit_user_registration_path(user) do%>
                                    <%= fa_icon "edit",class: "btn btn-outline-info" %>
                                    <% end %>
                                    <%= link_to '<i class="fa fa-trash-o fa-2x"></i>'.html_safe, user_path(user), class: "btn btn-outline-danger", method: :delete, data: {confirm: "Are you sure you want to delete the User?"} %>
                                <%end%>
                            <%end%> 
                        </p>
                    </td>
                </tr>
            <%end%>
        </table>
    </div>
    <div class="w3-center w3-padding-32">
        <div class="w3-bar">
            <%= will_paginate @user, :container => false, :class=>"w3-button w3-hover-black" %>
        </div>
  </div>

  <script>
    $("#search_input").blur(function() {
    $("#search_form").submit();
    });
  </script>
</body>
</html>